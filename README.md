# Casino Backend

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∫–∞–∑–∏–Ω–æ, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫–∞–∫ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NestJS –∏ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ Clean Architecture.

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ –≥–æ—Ç–æ–≤–∞—è –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –±—ç–∫–µ–Ω–¥-—Å–∏—Å—Ç–µ–º–∞ –∫–∞–∑–∏–Ω–æ, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑ 9 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤, –∫–∞–∂–¥—ã–π —Å–æ —Å–≤–æ–µ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö —á–µ—Ä–µ–∑ NATS. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ª–µ–¥—É–µ—Ç —Å—Ç—Ä–æ–≥–∏–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º Clean Architecture —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ —á–µ—Ç—ã—Ä–µ–º —Å–ª–æ—è–º: Presentation, Application, Domain –∏ Infrastructure.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤**: 9 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- **Clean Architecture**: –°—Ç—Ä–æ–≥–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤ —Å –∏–Ω–≤–µ—Ä—Å–∏–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **–ü–∞—Ç—Ç–µ—Ä–Ω CQRS**: –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø–∏—Å–∏, –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —á—Ç–µ–Ω–∏—è
- **–°–æ–±—ã—Ç–∏–π–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è**: NATS –¥–ª—è –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç–∏**: USD, EUR, BDT —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ —Ä–∞—Å—á–µ—Ç–∞–º–∏
- **–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Unit, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ E2E —Ç–µ—Å—Ç—ã —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ 100% –ø–æ–∫—Ä—ã—Ç–∏—è
- **–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω—ã–π TypeScript —Å–æ —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–∏–ø–æ–≤
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–∏—Å**: –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –≤–ª–∞–¥–µ–µ—Ç —Å–≤–æ–µ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
- **`users`** (–ø–æ—Ä—Ç 3000) - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ JWT
- **`balance`** (–ø–æ—Ä—Ç 3001) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω—ã–º –±–∞–ª–∞–Ω—Å–æ–º, —Å–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞
- **`payments`** (–ø–æ—Ä—Ç 3002) - –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π, –¥–µ–ø–æ–∑–∏—Ç—ã/–≤—ã–≤–æ–¥—ã
- **`games`** (–ø–æ—Ä—Ç 3004) - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏ –∏–≥—Ä, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏
- **`bonus`** (–ø–æ—Ä—Ç 3006) - –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–æ–≤, –æ—Ç—ã–≥—Ä—ã—à, –∫–∞–º–ø–∞–Ω–∏–∏
- **`currency-rate`** (–ø–æ—Ä—Ç 3007) - –ö—É—Ä—Å—ã –≤–∞–ª—é—Ç, –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (Open Exchange Rates), NATS-only
- **`cron`** - –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∑–∞–¥–∞—á–∏ –∏ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞–Ω–∏—è
- **`swagger-aggregator`** (–ø–æ—Ä—Ç 3100) - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

**–¢–µ—Å—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
- **`test-payment-provider`** (–ø–æ—Ä—Ç 3003) - –ú–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –ø–ª–∞—Ç–µ–∂–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **`test-game-provider`** (–ø–æ—Ä—Ç 3005) - –ú–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏–≥—Ä –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: NestJS 11 —Å TypeScript 5.7
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL 15 —Å Prisma 7 ORM
- **–û–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏**: NATS (–∫–ª–∞—Å—Ç–µ—Ä –∏–∑ 3 —É–∑–ª–æ–≤) –¥–ª—è request-reply –∏ pub/sub
- **–ö—ç—à/–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏**: Redis
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT —Ç–æ–∫–µ–Ω—ã
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: Swagger/OpenAPI
- **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∞—Å—á–µ—Ç—ã**: BigNumber.js (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bigint` –≤ –¥–æ–º–µ–Ω–Ω–æ–º –∫–æ–¥–µ)

### –°–ª–æ–∏ Clean Architecture

```
Presentation (–í–Ω–µ—à–Ω–∏–π —Å–ª–æ–π)
  ‚Üì –∑–∞–≤–∏—Å–∏—Ç –æ—Ç
Application (Use Cases)
  ‚Üì –∑–∞–≤–∏—Å–∏—Ç –æ—Ç
Domain (–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
  ‚Üì –∑–∞–≤–∏—Å–∏—Ç –æ—Ç
Infrastructure (–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –≤–Ω–µ—à–Ω–∏–µ API)
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:**
```
apps/{service}/src/
‚îú‚îÄ‚îÄ domain/              # –ß–∏—Å—Ç–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ entities/        # –ë–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏ —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ services/        # –î–æ–º–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ application/         # –°–ª–æ–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ use-cases/       # CQRS –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥/–∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ ports/           # –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ infrastructure/      # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ prisma/          # –°–ª–æ–π –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mapper/      # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ Entity ‚Üî Prisma
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories/ # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
‚îÇ   ‚îî‚îÄ‚îÄ external/        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
‚îî‚îÄ‚îÄ presentation/        # –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞
    ‚îú‚îÄ‚îÄ http/            # HTTP –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã + DTOs
    ‚îî‚îÄ‚îÄ nats/            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ NATS —Å–æ–æ–±—â–µ–Ω–∏–π
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 20+ –∏ npm
- Docker –∏ Docker Compose
- PostgreSQL 15+
- Git

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository-url>
cd casino-project

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose -f docker/docker-compose.local.yml up -d

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma –∫–ª–∏–µ–Ω—Ç—ã
npm run generate:all

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
npm run migrate:all:dev
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å –≤ —Ä–µ–∂–∏–º–µ watch
npm run start:users:debug
npm run start:balance:debug
npm run start:payments:debug
npm run start:games:debug
npm run start:bonus:debug
npm run start:currency-rate:debug

# –°–æ–±—Ä–∞—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
npm run build
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ:
- URL –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ (8 –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö)
- –°–µ—Ä–≤–µ—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–∞ NATS (3 —É–∑–ª–∞ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏)
- URL Redis
- JWT —Å–µ–∫—Ä–µ—Ç
- –ü–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (3000-3007)

**–í–∞–∂–Ω–æ**: –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ `/libs/shared/src/application/env/env.ts` —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π Zod.

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–õ–∞–∫–æ–Ω–∏—á–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ **[new-doc/](new-doc/)**:

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| [01-monorepo](new-doc/01-monorepo.md) | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, —Å–µ—Ä–≤–∏—Å—ã, —Å—Ç–µ–∫ |
| [02-architecture](new-doc/02-architecture.md) | Clean Architecture, —Å–ª–æ–∏, CQRS |
| [03-coding-style](new-doc/03-coding-style.md) | BigNumber, DTO, –≤–∞–ª—é—Ç–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –ª–∏–Ω—Ç–∏–Ω–≥ |
| [04-database](new-doc/04-database.md) | Prisma, –º–∏–≥—Ä–∞—Ü–∏–∏, seed, –∫–ª–∞—Å—Ç–µ—Ä PostgreSQL |
| [05-local-dev](new-doc/05-local-dev.md) | –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ |
| [06-docker](new-doc/06-docker.md) | Docker, compose, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ |
| [07-helm-k8s](new-doc/07-helm-k8s.md) | Helm, Kubernetes |
| [08-ci-cd](new-doc/08-ci-cd.md) | GitHub Actions, CI/CD |
| [09-games](new-doc/09-games.md) | –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∏–≥—Ä (Slotegrator, Jili, InOut) |
| [10-payments](new-doc/10-payments.md) | –ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã –ø–ª–∞—Ç–µ–∂–µ–π |
| [11-libs](new-doc/11-libs.md) | –†–∞–∑–¥–µ–ª—è–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ |
| [12-nats](new-doc/12-nats.md) | NATS, JetStream, –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è |
| [13-swagger-aggregator](new-doc/13-swagger-aggregator.md) | –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| [14-test-providers](new-doc/14-test-providers.md) | –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (payment, game) |
| [15-admin-endpoints](new-doc/15-admin-endpoints.md) | Admin API |

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- [WARP.md](WARP.md) ‚Äî —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤
- [AGENTS.md](AGENTS.md) ‚Äî –ø—Ä–∞–≤–∏–ª–∞ Cursor
- [–°–µ—Ä–≤–∏—Å Currency Rate](apps/currency-rate/FEATURES.md) ‚Äî –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç
- [E2E —Ç–µ—Å—Ç—ã](e2e/README.md) ‚Äî end-to-end —Ç–µ—Å—Ç—ã

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü–∏—Ä–∞–º–∏–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- **70% Unit —Ç–µ—Å—Ç–æ–≤** - –î–æ–º–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞, use cases, —É—Ç–∏–ª–∏—Ç—ã
- **20% –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
- **10% E2E —Ç–µ—Å—Ç—ã** - –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ HTTP –≤—ã–∑–æ–≤–∞–º–∏

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∑–∞–ø—É—Å–∫–æ–º —Ç–µ—Å—Ç–æ–≤)
npm run test:db:create

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
npm run test:users          # –í—Å–µ —Ç–µ—Å—Ç—ã
npm run test:users:unit     # –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
npm run test:users:integration  # –¢–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
npm run test:users:watch    # –†–µ–∂–∏–º watch

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
npm run test:all
npm run test:all:unit
npm run test:all:integration
npm run test:e2e

# –ü–æ–∫—Ä—ã—Ç–∏–µ
npm run test:users:coverage
```

### E2E —Ç–µ—Å—Ç—ã

E2E —Ç–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø–æ–ª–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–∏ —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–µ HTTP –≤—ã–∑–æ–≤—ã –∫–æ –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º. –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã (`docker-compose up -d` –∏–ª–∏ `npm run start:local`) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ seed.

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ E2E —Ç–µ—Å—Ç—ã
npm run test:e2e

# –ó–∞–ø—É—Å—Ç–∏—Ç—å E2E –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—è–º
npm run test:bonus:e2e      # –ü–µ—Ä–≤—ã–π –¥–µ–ø–æ–∑–∏—Ç —Å –±–æ–Ω—É—Å–æ–º, –æ—Ç—ã–≥—Ä—ã—à
npm run test:payments:e2e   # –î–µ–ø–æ–∑–∏—Ç—ã, –≤—ã–≤–æ–¥—ã, –∫–æ–º–∏—Å—Å–∏—è

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
npm run test:e2e -- --testPathPattern="bonus-e2e-first-deposit"
npm run test:e2e -- --testPathPattern="payments-e2e-withdrawal-commission"
```

**–°—Ü–µ–Ω–∞—Ä–∏–∏ E2E:**
- **First Deposit Bonus** ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –¥–µ–ø–æ–∑–∏—Ç —Å –±–æ–Ω—É—Å–æ–º, –æ—Ç—ã–≥—Ä—ã—à, –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
- **Deposit without Bonus** ‚Äî –¥–µ–ø–æ–∑–∏—Ç—ã –±–µ–∑ –≤—ã–±–æ—Ä–∞ –±–æ–Ω—É—Å–∞, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –±–æ–Ω—É—Å–æ–≤
- **Withdrawal Commission** ‚Äî –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ —Å —É—á—ë—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–∏
- **Concurrent Operations** ‚Äî –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: **[e2e/README.md](e2e/README.md)**

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–µ—Å—Ç–∞–º

**–¢—Ä–µ–±—É–µ—Ç—Å—è 100% –ø–æ–∫—Ä—ã—Ç–∏–µ:**
- ‚úÖ –ö–∞–∂–¥–∞—è –¥–æ–º–µ–Ω–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å ‚Üí `entity-name.spec.ts`
- ‚úÖ –ö–∞–∂–¥—ã–π –¥–æ–º–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å ‚Üí `service-name.spec.ts`
- ‚úÖ –ö–∞–∂–¥—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ use case ‚Üí `handler-name.spec.ts`
- ‚úÖ –ö–∞–∂–¥—ã–π HTTP –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä ‚Üí `controller.spec.ts` (unit) + `controller.integration.spec.ts`
- ‚úÖ –ö–∞–∂–¥—ã–π NATS –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä ‚Üí `controller.spec.ts` (unit) + `controller.integration.spec.ts`
- ‚úÖ –ö–∞–∂–¥—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí `repository.integration.spec.ts`
- ‚úÖ –ö–∞–∂–¥—ã–π –º–∞–ø–ø–µ—Ä ‚Üí `mapper.spec.ts`

## üóÑÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prisma

–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –∏–º–µ–µ—Ç —Å–≤–æ—é –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ö–µ–º—É Prisma:

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å Prisma –∫–ª–∏–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
npm run generate:users
npm run generate:balance
npm run generate:payments
npm run generate:games
npm run generate:bonus
npm run generate:all

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
npm run migrate:users:dev
npm run migrate:balance:dev
npm run migrate:all:dev

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ (—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
npm run migrate:all:deploy
```

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–∏—Å:**
- `users_db` ‚Üí –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å Users
- `balance_db` ‚Üí –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å Balance
- `payments_db` ‚Üí –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å Payments
- `games_db` ‚Üí –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å Games
- `bonus_db` ‚Üí –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å Bonus
- `currency_rate_db` ‚Üí –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å Currency Rate

**–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–≥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞–ø—Ä—è–º—É—é. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ NATS –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ.**

## üîÑ –ú–µ–∂—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

### NATS –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç–µ NATS subjects. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã.**

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ò–º–ø–æ—Ä—Ç –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
import { BalancePublisher } from '@lib/lib-balance';
const response = await balancePublisher.createUserBalance(request);

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –•–∞—Ä–¥–∫–æ–¥ subject
natsClient.send('balance.create-user-balance.v1', data);
```

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏:**
- `@lib/lib-balance` - BalancePublisher, BalanceSubjects
- `@lib/lib-games` - GamesPublisher, GamesSubjects
- `@lib/lib-payments` - PaymentsPublisher, PaymentsSubjects
- `@lib/lib-bonus` - BonusPublisher, BonusSubjects
- `@lib/lib-users` - UsersPublisher, UsersSubjects
- `@lib/lib-currency-rate` - CurrencyRatePublisher, –∫—ç—à –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç

**–ü–∞—Ç—Ç–µ—Ä–Ω:**
- Request-Reply: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Publishers –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
- Pub/Sub: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ subjects –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π

## üõ†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –∫–∞–∫–æ–º—É —Å–µ—Ä–≤–∏—Å—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏—è
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –¥–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏/value objects (–¥–æ–º–µ–Ω–Ω—ã–π —Å–ª–æ–π)
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–æ—Ä—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–∫ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã (application/ports)
4. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ use cases (application/use-cases)
5. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π)
6. –°–æ–∑–¥–∞–π—Ç–µ HTTP/NATS –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã (—Å–ª–æ–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)
7. –ï—Å–ª–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç–µ –º–µ–∂—Å–µ—Ä–≤–∏—Å–Ω—É—é –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é, –æ–±–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
8. –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã, —Å–ª–µ–¥—É—è –ø–∏—Ä–∞–º–∏–¥–µ (unit ‚Üí –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ ‚Üí E2E)
9. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run lint` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ö–µ–º—É Prisma: `prisma/{service}/schema.prisma`
2. –°–æ–∑–¥–∞–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é: `npm run migrate:{service}:dev`
3. –†–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª–∏–µ–Ω—Ç: `npm run generate:{service}`
4. –û–±–Ω–æ–≤–∏—Ç–µ –º–∞–ø–ø–µ—Ä—ã –≤ `infrastructure/prisma/mapper/`
5. –û–±–Ω–æ–≤–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
6. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run lint`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ NATS –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏

1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ subject –∏ —Ç–∏–ø—ã –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ —Å–µ—Ä–≤–∏—Å–∞ (`libs/lib-{service}/src/subjects.ts`)
2. –°–æ–∑–¥–∞–π—Ç–µ/–æ–±–Ω–æ–≤–∏—Ç–µ publisher –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ (`libs/lib-{service}/src/publishers/`)
3. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Å–µ—Ä–≤–∏—Å–∞ (`apps/{service}/src/presentation/nats/`)
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ publisher –∏–∑ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç–µ subjects)
5. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run lint`

## üìã –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞

### –ù–ï –î–ï–õ–ê–ô–¢–ï:

- ‚ùå –†–∞–∑–º–µ—â–∞–π—Ç–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ —Å–ª–æ—è—Ö application/infrastructure
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Prisma –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç—ã)
- ‚ùå –•–∞—Ä–¥–∫–æ–¥–∏—Ç–µ NATS subjects (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã)
- ‚ùå –û–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –ø–æ—Ä—Ç—ã –∫–∞–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è NestJS DI)
- ‚ùå –û–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞–ø—Ä—è–º—É—é (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ NATS)
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bigint` –≤ –¥–æ–º–µ–Ω–Ω–æ–º/–ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º –∫–æ–¥–µ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `BigNumber`)
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø `number` –¥–ª—è ID/—Å—É–º–º –≤ DTOs (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `string`)
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –õ–Æ–ë–´–ï —Å—Ç—Ä–æ–∫–∏ –≤–∞–ª—é—Ç/—è–∑—ã–∫–æ–≤ (–¢–û–õ–¨–ö–û –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Currency` –∏–∑ `@lib/shared/currency`)
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç–Ω—ã–µ —Ç–∏–ø—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–æ–ø—Ä–µ–¥–µ–ª—è–π—Ç–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Å–∞/—Ñ–∞–π–ª–∞)
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø `any` (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `unknown` —Å type guards)
- ‚ùå –ü—Ä–æ–ø—É—Å–∫–∞–π—Ç–µ –∑–∞–ø—É—Å–∫ `npm run lint` –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞

### –î–ï–õ–ê–ô–¢–ï:

- ‚úÖ –î–µ—Ä–∂–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ç–æ–Ω–∫–∏–º–∏ (<50 —Å—Ç—Ä–æ–∫)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω CQRS (–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø–∏—Å–∏, –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è —á—Ç–µ–Ω–∏—è)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–ª–∏–∞—Å—ã –ø—É—Ç–µ–π (@app/*, @lib/*, @prisma/*)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é —Å—Ç—Ä–æ–∫ –¥–ª—è ID/—Å—É–º–º –≤ DTOs
- ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫–∏ –≤ BigNumber —Å –ø–æ–º–æ—â—å—é `stringToBigNumber()`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bigIntToBigNumber()` –∏ `bigNumberToBigInt()` –≤ –º–∞–ø–ø–µ—Ä–∞—Ö
- ‚úÖ –°–ª–µ–¥—É–π—Ç–µ –ø–∏—Ä–∞–º–∏–¥–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (70% unit, 20% –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ, 10% E2E)
- ‚úÖ –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `npm run lint` –ø–æ—Å–ª–µ –ö–ê–ñ–î–û–ì–û –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

## üîë –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### BigNumber vs BigInt

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û**: –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bigint` –≤ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º –∏–ª–∏ –¥–æ–º–µ–Ω–Ω–æ–º –∫–æ–¥–µ. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `BigNumber` –∏–∑ `bignumber.js`.

**–ì–¥–µ —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏, DTOs, —Å–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: **–í–°–ï–ì–î–ê `BigNumber`**
- –ü–æ—Ä—Ç—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ (–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã): **–í–°–ï–ì–î–ê `BigNumber`**
- –ú–∞–ø–ø–µ—Ä—ã Prisma: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `bigIntToBigNumber()` –∏ `bigNumberToBigInt()` –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–π
- –°—Ö–µ–º—ã Prisma –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã: `bigint` (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)

**–£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
```typescript
import { 
  bigIntToBigNumber,    // Prisma ‚Üí Domain
  bigNumberToBigInt,    // Domain ‚Üí Prisma
  stringToBigNumber     // HTTP DTO ‚Üí Domain
} from '@lib/shared';
```

### –í–∞–ª—é—Ç–∞ –∏ —è–∑—ã–∫

**–ê–ë–°–û–õ–Æ–¢–ù–û–ï –ü–†–ê–í–ò–õ–û**: –°—Ç—Ä–æ–∫–∏ –≤–∞–ª—é—Ç –∏ —è–∑—ã–∫–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ enums –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã **–ó–ê–ü–†–ï–©–ï–ù–´**.

**–¢–û–õ–¨–ö–û —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:**
- `@lib/shared/currency` - Enum –≤–∞–ª—é—Ç –∏ —É—Ç–∏–ª–∏—Ç—ã –¢–û–õ–¨–ö–û
- `@lib/shared/language` - –ö–ª–∞—Å—Å —è–∑—ã–∫–∞ –∏ —É—Ç–∏–ª–∏—Ç—ã –¢–û–õ–¨–ö–û

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
import { Currency } from '@lib/shared/currency';
currency: z.nativeEnum(Currency)

// ‚ùå –ó–ê–ü–†–ï–©–ï–ù–û
if (payment.currency === 'USD') { }  // –ù–ò–ö–û–ì–î–ê
const curr = 'USD';  // –ù–ò–ö–û–ì–î–ê
```

### DTOs –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç—Ä–æ–∫

–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø `string` –¥–ª—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å—É–º–º –≤ HTTP DTOs, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é —á–∏—Å–µ–ª JavaScript (MAX_SAFE_INTEGER = 2^53 - 1).

```typescript
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
export const PaymentRequestSchema = z.object({
  userId: z.string().regex(/^\d+$/),
  amount: z.string().regex(/^\d+$/),
});

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
export const PaymentRequestSchema = z.object({
  userId: z.number().int().positive(),  // –ü–æ—Ç–µ—Ä—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è ID > 2^53
});
```

## üì¶ –ê–ª–∏–∞—Å—ã –ø—É—Ç–µ–π

```typescript
// –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è
@app/users/*
@app/balance/*
@app/payments/*
@app/games/*
@app/bonus/*
@app/currency-rate/*

// –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
@lib/shared/*              // –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã, auth, health
@lib/lib-balance/*         // –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ Balance
@lib/lib-games/*           // –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ Games
@lib/lib-payments/*        // –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ Payments
@lib/lib-bonus/*           // –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ Bonus
@lib/lib-users/*           // –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ Users
@lib/lib-currency-rate/*   // –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ Currency Rate

// Prisma –∫–ª–∏–µ–Ω—Ç—ã (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞)
@prisma/users
@prisma/balance
@prisma/payments
@prisma/games
@prisma/bonus
@prisma/currency-rate
```

## üö¢ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

–î–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ —Å–º.:
- **[CI/CD](new-doc/08-ci-cd.md)** ‚Äî GitHub Actions, —Å–±–æ—Ä–∫–∞, –¥–µ–ø–ª–æ–π
- **[Helm/K8s](new-doc/07-helm-k8s.md)** ‚Äî Kubernetes, –º–∏–≥—Ä–∞—Ü–∏—è

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [new-doc/](new-doc/) ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Å—Ç–∏–ª—å –∫–æ–¥–∞, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
2. –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run lint` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º
4. –°–ª–µ–¥—É–π—Ç–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º Clean Architecture

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç–Ω—ã–º –∏ –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–º.

## üîó –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è NestJS](https://docs.nestjs.com)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Prisma](https://www.prisma.io/docs)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è NATS](https://docs.nats.io)
- [Clean Architecture –æ—Ç Robert C. Martin](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)

---

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** [new-doc/](new-doc/) ¬∑ [WARP.md](WARP.md) ¬∑ [AGENTS.md](AGENTS.md)
