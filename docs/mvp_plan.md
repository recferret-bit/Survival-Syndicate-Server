# MVP План: "Каркас" серверной архитектуры

## 1. Цель MVP

Основная цель этого MVP — **проверить и отладить всю межсервисную коммуникацию**, описанную в архитектурных документах, без реализации сложной игровой логики (`GameLoop`).

## 2. Список сервисов в MVP

### А. Центральная Зона (Global Scope)
1.  **Auth Service**
2.  **Matchmaking Service** (включая логику Лобби)
3.  **Player Service**

### Б. Локальная Зона (Zone Scope)
1.  **Local Orchestrator**
2.  **Gameplay Service**
3.  **WebSocket Service**

## 3. Задачи для реализации (Таск-борд)

### Epic 1: Базовая инфраструктура
-   [ ] **TASK-1.1:** Создать Monorepo-структуру проекта.
-   [ ] **TASK-1.2:** Настроить Docker Compose для всех сервисов.
-   [ ] **TASK-1.3:** Создать общую `libs` библиотеку.

### Epic 2: Реализация сервисов-"заглушек"
-   [ ] **TASK-2.1:** **Auth Service:**
    -   Реализовать регистрацию и логин.
    -   Публиковать событие `user.registered`.
-   [ ] **TASK-2.2:** **Player Service:**
    -   Подписаться на `user.registered` и создавать профиль игрока.
-   [ ] **TASK-2.3:** **Matchmaking Service:**
    -   Реализовать HTTP эндпоинты для управления лобби (`/api/lobbies/*`).
    -   Реализовать `POST /api/matchmaking/join-solo` для быстрого старта.
    -   Подписаться на `orchestrator.zone.heartbeat`.
-   [ ] **TASK-2.4:** **Local Orchestrator:**
    -   Реализовать публикацию `orchestrator.zone.heartbeat`.
    -   Подписаться на `gameplay.service.heartbeat`.
    -   Реализовать логику выбора `Gameplay Service` и отправки команды `gameplay.start_simulation`.
-   [ ] **TASK-2.5:** **Gameplay Service:**
    -   Реализовать публикацию `gameplay.service.heartbeat`.
    -   Подписаться на `gameplay.start_simulation`.
    -   Реализовать **честное управление** `Map`'ой инстансов симуляций.
-   [ ] **TASK-2.6:** **WebSocket Service:**
    -   Реализовать аутентификацию `client.authenticate`.
    -   Реализовать логику синхронизации состояния лобби (`server.lobby.state_update`).
    -   Реализовать простое "эхо" в игровом режиме.

### Epic 3: Интеграционное тестирование
-   [ ] **TASK-3.1:** Написать e2e тест, покрывающий флоу с созданием лобби и стартом матча.

## 4. Требования к качеству (Definition of Done)
-   **Unit-тесты:** Все новые контроллеры и сервисы/use-cases должны быть покрыты unit-тестами.
-   **Линтинг:** Весь код проходит проверку линтером.
-   **Документация:** Все эндпоинты и события задокументированы.
